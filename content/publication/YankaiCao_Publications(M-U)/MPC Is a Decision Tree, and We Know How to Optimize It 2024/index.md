---
title: "MPC Is a Decision Tree, and We Know How to Optimize It"
tags: []
authors: ['Jiayang Ren', 'Yankai Cao']
publication_types: []
publication: "*2024 AIChE Annual Meeting*"
abstract: "Model Predictive Control (MPC) has gained extensive adoption in the process industry due to its superior control performance and its ability to handle constraints [1]. However, the real-time computational demands of solving the optimization problem often restrict MPC implementation in systems characterized by fast dynamics or limited computational resources.
One strategy to address this challenge is to compute or approximate optimal control law offline. Explicit MPC, for instance, computes piecewise affine functions of the system states as control laws for MPC problems with linear plant models [2], [3]. Nonetheless, the scalability of Explicit MPC to large-scale systems faces obstacles due to the exponential growth of partitions with increasing system states and control horizons. An alternative approach involves approximating the MPC control law via neural networks [4], [5], [6]. However, one limitation of the neural network control law is its inherent lack of interpretability, making it difficult for engineers to comprehend the decision-making process, which is crucial in safety-critical systems.
In this paper, we propose to train oblique decision trees (DTs) with linear predictions to approximate the MPC control laws offline, followed by utilizing the DT model as the online controller. This method is based on the observation that MPC control law can be viewed as a DT. As illustrated in Figure 1, DTs with oblique splits at the branch nodes and linear predictions at the leaf nodes exhibit the same formulations as piecewise affine functions, akin to explicit MPC control law. One notable advantage of the DT control law lies in its interpretability; it follows if-else rules, akin to human reasoning, and is easily comprehensible by human decision-makers. Furthermore, scalability is another key benefit, as the control law can be derived through a data-driven approach, with the training dataset generated by simulating an ideal MPC in parallel.
One key challenge of the proposed method is computing the most accurate DT model from a dataset, which is a mixed-integer optimization problem [7]. To tackle this challenge, we introduce a novel gradient-based algorithm tailored for oblique decision tree training. This approach involves approximating the gradients of indicator functions using scaled sigmoid functions, enabling effective utilization of existing machine learning packages on GPUs.
We validate the effectiveness of the proposed method through various case studies, demonstrating its capability to accurately approximate the MPC control law while significantly reducing the online computational time. This approach matches the performance of the ground truth control law for linear MPC and accurately approximates the control law for nonlinear MPC."
date: "2024-10-30"
publishDate: "2024-10-30"
url_pdf: "https://scholar.google.ca/citations?view_op=view_citation&hl=zh-CN&user=M-s3mjAAAAAJ&cstart=80&citation_for_view=M-s3mjAAAAAJ:u9iWguZQMMsC"
featured: false
projects: []
slides: ""
---
